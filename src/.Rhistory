# functions to visualize output
source("postprocess_visualization.R")
# load outputs from NeuroPM
path = "C:/Users/zxiong/io" #"fmrib/NeuroPM/io/"
psuedotimes = read.csv(file.path(path,"pseudotimes.csv"), header=TRUE)
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
# load outputs from NeuroPM
path = "C:/Users/zxiong/Desktop/io" #"fmrib/NeuroPM/io/"
psuedotimes = read.csv(file.path(path,"pseudotimes.csv"), header=TRUE)
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
View(psuedotimes)
View(weight_vars)
ukb_df = read.csv(file.path(path,"ukb_num.csv"),header=TRUE)
source("postprocess_visualization.R")
# load outputs from NeuroPM
path = "C:/Users/zxiong/Desktop/io" #"fmrib/NeuroPM/io/"
ukb_df = read.csv(file.path(path,"ukb_num.csv"),header=TRUE)
psuedotimes = read.csv(file.path(path,"pseudotimes.csv"), header=TRUE)
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
# box plot by group
plot_boxplot_by_group(data = psuedotimes,
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Blood Pressure Groups", ylab = "Disease Score",
labels = c("Between", "Background", "Disease"))
# box plot by group
plot_boxplot_by_group(data = psuedotimes,
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
ylim=c(0,1),
title = "Disease Progression by Blood Pressure Group",
xlab = "Blood Pressure Groups", ylab = "Disease Score",
labels = c("Between", "Background", "Disease"))
# box plot by group
plot_boxplot_by_group(data = psuedotimes,
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
# ylim=c(0,1),
title = "Disease Progression by Blood Pressure Group",
xlab = "Blood Pressure Groups", ylab = "Disease Score",
labels = c("Between", "Background", "Disease"))
# functions to visualize output
source("postprocess_visualization.R")
# box plot by group
plot_boxplot_by_group(data = psuedotimes,
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
# ylim=c(0,1),
title = "Disease Progression by Blood Pressure Group",
xlab = "Blood Pressure Groups", ylab = "Disease Score",
labels = c("Between", "Background", "Disease"))
min(ukb_df)
max(ukb_df)
# box plot by group
plot_boxplot_by_group(data = psuedotimes,
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
ylim=c(0,1),
title = "Disease Progression by Blood Pressure Group",
xlab = "Blood Pressure Groups", ylab = "Disease Score",
labels = c("Between", "Background", "Disease"))
# line plot by group
plot_line_by_group(data = psuedotimes,
x = psuedotimes$BPSys_2_0,
#x =
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
View(weight_vars)
weight_vars$Var1[order(weight_vars$Node_contributions)]
weight_vars$Var1[order(weight_vars$Node_contributions),decreasing=FALSE]
weight_vars$Var1[order(weight_vars$Node_contributions,decreasing=FALSE)]
# normalize weighting vars
weight_vars$Node_contributions = weight_vars$Node_contributions /
sum(weight_vars$Node_contributions)
View(weight_vars)
sum(weight_vars$Node_contributions)
_
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
# normalize weighting vars
weight_vars$Node_contributions = weight_vars$Node_contributions /
sum(weight_vars$Node_contributions) * 100
# new column for whether weight is above or below thresholding
weight_vars$thres_above = weight_vars$Node_contributions > weight_thres
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
# new column for whether weight is above or below thresholding
weight_vars$thres_above = weight_vars$Node_contributions > weight_thres
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
# new column for whether weight is above or below thresholding
weight_vars$thres_above = weight_vars$Node_contributions > weight_thres
# normalize weighting vars
weight_vars$Node_contributions = weight_vars$Node_contributions /
sum(weight_vars$Node_contributions) * 100
sum(weight_vars$thres_above)
# display number of variables above the threshold
print(sprintf("Number of Variables Above Threshold is %.0f//%0.f",
sum(weight_vars$thres_above),nrow(weight_vars)))
# display number of variables above the threshold
print(sprintf("Number of Variables Above Threshold is %.0f/%0.f",
sum(weight_vars$thres_above),nrow(weight_vars)))
weight_vars = read.csv(file.path(path,"var_weighting.csv"), header=TRUE)
weight_thres = as.numeric(read.csv(file.path(path,"threshold_weighting.csv"),
header=TRUE))
# new column for whether weight is above or below thresholding
weight_vars$thres_above = weight_vars$Node_contributions > weight_thres
# display number of variables above the threshold
print(sprintf("Number of Variables Above Weight Threshold is %.0f/%0.f",
sum(weight_vars$thres_above),nrow(weight_vars)))
# normalize weighting vars
weight_vars$Node_contributions = weight_vars$Node_contributions /
sum(weight_vars$Node_contributions) * 100
plot(sort(weight_vars$Node_contributions))
plot(sort(weight_vars$Node_contributions),log="y")
hist(sort(weight_vars$Node_contributions))
plot(sort(weight_vars$Node_contributions),log="y")
weight_vars$Var1
weight_vars$Var1[order(weight_vars$Node_contributions)]
weight_vars$Var1[order(weight_vars$Node_contributions),decreasing=TRUE]
weight_vars$Var1[order(weight_vars$Node_contributions,decreasing=TRUE)]
View(weight_vars)
# get list of variables sorted from high to low weighting
var_sorted = weight_vars$Var1[order(weight_vars$Node_contributions,
decreasing=TRUE)]
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])]
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
var_sorted[1]
View(ukb_df)
head(weight_vars$Var1)
var_sorted = gsub(".","_",var_sorted)
var_sorted
# get list of variables sorted from high to low weighting
var_sorted = weight_vars$Var1[order(weight_vars$Node_contributions,
decreasing=TRUE)]
var_sorted = gsub("\.","_",var_sorted)
# get list of variables sorted from high to low weighting
var_sorted = weight_vars$Var1[order(weight_vars$Node_contributions,
decreasing=TRUE)]
var_sorted = gsub("\\.","_",var_sorted)
var_sorted
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
var_sorted[1]
View(weight_vars)
# get list of variables sorted from high to low weighting
var_sorted = weight_vars$Var1[order(weight_vars$Node_contributions,
decreasing=TRUE)]
var_sorted = gsub("_","\\.",var_sorted)
var_sorted
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
var_sorted[1]
# get list of variables sorted from high to low weighting
# also re-format these variable names since matlab screwed it up
var_sorted = weight_vars$Var1[order(weight_vars$Node_contributions,
decreasing=TRUE)]
var_sorted = gsub("_","\\.",var_sorted)
var_sorted = gsub("x","X.",var_sorted)
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
var_sorted[1]
# get list of variables sorted from high to low weighting
# also re-format these variable names since matlab screwed it up
var_sorted = weight_vars$Var1[order(weight_vars$Node_contributions,
decreasing=TRUE)]
var_sorted = gsub("_","\\.",var_sorted)
var_sorted = gsub("x","X",var_sorted)
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
xlab = "Systolic Blood Pressure", ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Blood Pressure Group",
ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
View(psuedotimes)
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
View(psuedotimes)
# assign bp_groups as the real labels
psuedotimes$bp_group[psuedotimes$bp_group == 0] = "Between"
psuedotimes$bp_group[psuedotimes$bp_group == 1] = "Background"
psuedotimes$bp_group[psuedotimes$bp_group == 2] = "Disease"
psuedotimes$bp_group = ordered(psuedotimes$bp_group,
levels = c("Background","Between","Disease"))
psuedotimes$bp_group
# box plot by group
plot_boxplot_by_group(data = psuedotimes,
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
ylim=c(0,1),
title = "Disease Progression by Blood Pressure Group",
xlab = "Blood Pressure Groups", ylab = "Disease Score",
labels = c("Between", "Background", "Disease"))
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[1])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[2])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# functions to visualize output
source("postprocess_visualization.R")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[2])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[3])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[4])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
View(psuedotimes)
View(ukb_df)
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[900])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
# line plot by group
plot_line_by_group(data = psuedotimes,
#x = psuedotimes$BPSys_2_0,
x = ukb_df[,c(var_sorted[10])],
y = psuedotimes$global_pseudotimes,
group = psuedotimes$bp_group,
title = "Disease Progression by Variable",
xlab = "Variable", ylab = "Disease Score")
